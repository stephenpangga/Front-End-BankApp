<script src="https://code.jquery.com/jquery-3.4.1.js"></script>
<script>
//post
/*$.ajax({
            type: 'POST',
            url: 'https://banking-appv3.herokuapp.com/api/transactions',
            contentType: 'application/json',
            data: JSON.stringify({
                "amount": 100,
                "transactionType": "transfer"
            }),
            success: data => {
                data.forEach(transaction => {
                    $("#transaction").append(`Balance of account ${transaction.sender.iban}: ${transaction.sender.balance}<br>`);
                });
            }
        })*/
        
function getRecipient(callback){
    let recipient = document.getElementById("recipient").value;
    $.ajax({
        type: 'GET',
        url: 'http://localhost:8090/api/accounts/' + recipient,
        contentType: 'application/json',
        success: data => {
                callback(data)
                }
    });
}
function submit() {
    //this is something that needs to be passed on somehow tho
    //okay so how that works basically is
    //you'll have to add to every request a header called "Authorization"
    //the value of it is a token that should be stored in the client's session
    let theAccount = {
        balance: 100.0,
        currency: "Euro",
        cumulativeTransaction: 5,
        transactionAmoutLimit: 10000.0,
        absoluteLimit: 10.0,
        iban: "NL01INHO0000000001",
        owner: {
            id: 1,
            email: "inholland@gmail.com",
            password: "inhollandbank",
            firstName: "Bank",
            lastName: "bank",
            accessLevel: "employee"
        },
        accountType: "current"
    }
    let loggedInUser = {
        id: 1,
        email: "inholland@gmail.com",
        password: "inhollandbank",
        firstName: "Bank",
        lastName: "bank",
        accessLevel: "employee"
    }
    let amount = document.getElementById("amount").value; 
    
    getRecipient(recipient => {
      console.log("recipient: " + JSON.stringify(recipient));

    let x = {
          sender: theAccount,
          recipient: recipient,
          amount: amount,
          transactionType: "transfer",
          userPerforming: loggedInUser
        }
    
    $.ajax({
        type: 'POST',
        //url: 'https://banking-appv3.herokuapp.com/api/transactions',
        url: 'http://localhost:8090/api/transactions',
        contentType: 'application/json',
        data: JSON.stringify(x),
        success: console.log("success")
    })
  });
}
</script>


<h1> Transfer Money </h1>

<label for="amount">Amount </label><br>
<input type="text" id="amount" name="amount" value="0"><br>
<label for="recipient">Recipient: </label><br>
<input type="text" id="recipient" name="recipient" value="NL01INHO0000000001"><br><br>

<button onclick="submit()"> 
    submit
</button>
